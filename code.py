dataOld = '''[
    {
        "occurrences": [
            {
                "reportableFlag": "Y",
                "occurrenceIdentifier": 2199959,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": false,
                        "identifier": 85755,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2022-04-26",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 249,
                        "filingIdentifier": 5000410,
                        "judgementLien": {
                            "disclosureDiscoveredDateDetails": {
                                "date": "2022-04-21"
                            },
                            "courtDetails": {
                                "courtTypeCode": "STATE",
                                "courtName": "SUPREME COURT OF THE STATE OF NEW YORK",
                                "courtLocation": "MINEOLA, NY"
                            },
                            "disclosureEventPendingFlag": "Y",
                            "courtCaseNumberPIIFlag": "N",
                            "disclosureEventDateDetails": {
                                "date": "2022-04-11"
                            },
                            "disclosureEventTypeCode": "CIVIL",
                            "judgementLienOwedAmount": 395445.46,
                            "lienHolderName": "XYZ, INC."
                        }
                    }
                ],
                "discloseToPublicFlag": "Y"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 2014951,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": false,
                        "identifier": 8038792,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2019-01-30",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 249,
                        "filingIdentifier": 50892905,
                        "judgementLien": {
                            "disclosureDiscoveredDateDetails": {
                                "date": "2019-01-25",
                                "dateExplanation": "FINRA INQUIRY LETTER"
                            },
                            "courtDetails": {
                                "courtTypeCode": "OTHER",
                                "courtName": "KMT GROUP LLC",
                                "courtLocation": "NASSAU COUNTY, NY",
                                "courtTypeOtherText": "KMT GROUP LLC"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "N",
                            "disclosureEventDateDetails": {
                                "date": "2009-11-25"
                            },
                            "dispositionTypeCode": "REMOVED",
                            "disclosureEventTypeCode": "CIVIL",
                            "judgementLienOwedAmount": 8231,
                            "lienHolderName": "KMT GROUP LLC",
                            "dispositionDateDetails": {
                                "date": "2010-08-10",
                                "dateExplanation": "FILED THROUGH CHAPTER 7 BANKRUPTCY FILING, CASE # 10-76287"
                            }
                        }
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1826610,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": false,
                        "identifier": 7841506,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2015-09-21",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 793,
                        "filingIdentifier": 41899188,
                        "judgementLien": {
                            "disclosureDiscoveredDateDetails": {
                                "date": "2008-11-23",
                                "dateExplanation": "not sure of the exact date"
                            },
                            "courtDetails": {
                                "courtTypeCode": "OTHER",
                                "courtName": "NY State Deparment of Taxation and Finance",
                                "courtLocation": "Albany,NY",
                                "courtTypeOtherText": "Recorder of Deeds"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "N",
                            "disclosureEventDateDetails": {
                                "date": "2008-10-23"
                            },
                            "dispositionTypeCode": "PAID",
                            "disclosureEventTypeCode": "TAX",
                            "judgementLienOwedAmount": 6771.19,
                            "lienHolderName": "Commissioner of Taxation and Finance",
                            "dispositionDateDetails": {
                                "date": "2009-05-19"
                            }
                        }
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1826609,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": false,
                        "identifier": 7841510,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2015-09-21",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 793,
                        "filingIdentifier": 41899188,
                        "judgementLien": {
                            "disclosureDiscoveredDateDetails": {
                                "date": "2009-08-10",
                                "dateExplanation": "Not sure of the exact date"
                            },
                            "courtDetails": {
                                "courtTypeCode": "OTHER",
                                "courtName": "Internal Revenue Service",
                                "courtLocation": "Mineola,NY",
                                "courtTypeOtherText": "Recorder of Deeds"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "N",
                            "disclosureEventDateDetails": {
                                "date": "2009-07-10"
                            },
                            "dispositionTypeCode": "RELEASED",
                            "disclosureEventTypeCode": "TAX",
                            "judgementLienOwedAmount": 117255.98,
                            "lienHolderName": "IRS",
                            "dispositionDateDetails": {
                                "date": "2014-01-17"
                            }
                        }
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1826608,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": false,
                        "identifier": 7841515,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2015-09-21",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 793,
                        "filingIdentifier": 41899188,
                        "judgementLien": {
                            "disclosureDiscoveredDateDetails": {
                                "date": "2008-04-03",
                                "dateExplanation": "not sure of the exact date"
                            },
                            "courtDetails": {
                                "courtTypeCode": "OTHER",
                                "courtName": "Internal Revenue Service",
                                "courtLocation": "Mineola,NY",
                                "courtTypeOtherText": "IRS"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "N",
                            "disclosureEventDateDetails": {
                                "date": "2008-03-03"
                            },
                            "dispositionTypeCode": "RELEASED",
                            "disclosureEventTypeCode": "TAX",
                            "judgementLienOwedAmount": 36805.18,
                            "lienHolderName": "IRS",
                            "dispositionDateDetails": {
                                "date": "2012-09-12"
                            }
                        }
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1826607,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": false,
                        "identifier": 7841525,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2015-09-21",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 793,
                        "filingIdentifier": 41899188,
                        "judgementLien": {
                            "disclosureDiscoveredDateDetails": {
                                "date": "2007-07-26",
                                "dateExplanation": "Not Sure of the exact date"
                            },
                            "courtDetails": {
                                "courtTypeCode": "OTHER",
                                "courtName": "Internal Revenue Service",
                                "courtLocation": "Mineola,NY",
                                "courtTypeOtherText": "IRS"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "N",
                            "disclosureEventDateDetails": {
                                "date": "2007-06-26"
                            },
                            "dispositionTypeCode": "RELEASED",
                            "disclosureEventTypeCode": "TAX",
                            "judgementLienOwedAmount": 33092.78,
                            "lienHolderName": "IRS",
                            "dispositionDateDetails": {
                                "date": "2012-08-22"
                            }
                        }
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1523769,
                "disclosures": [
                    {
                        "disclosureTypeCode": "BANKRUPT",
                        "amendment": false,
                        "identifier": 1466607,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2011-02-08",
                        "questions": "14K(1)",
                        "submittingFirmCrdNumber": 249,
                        "bankruptcy": {
                            "courtActionDetails": {
                                "courtTypeCode": "FEDERAL",
                                "courtName": "UHITED STATES BANKRUPTYC COURT",
                                "courtLocation": "EASTERN DISTRICT OF NEW YORK"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "N",
                            "bankruptcyActionTypeCode": "BANKRUPTCY",
                            "disclosureEventDateDetails": {
                                "date": "2010-08-10",
                                "exactDate": "Y"
                            },
                            "dispositionDetails": {
                                "dispositionTypeCode": "DISCHARGED",
                                "dispositionDateDetails": {
                                    "date": "2011-01-14",
                                    "exactDate": "Y"
                                }
                            },
                            "bankruptcyActionChapterTypeCode": "CHAPTER07"
                        },
                        "filingIdentifier": 51453261
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1508722,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": true,
                        "identifier": 1452216,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2012-02-10",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 793,
                        "filingIdentifier": 31929715,
                        "judgementLien": {
                            "courtDetails": {
                                "courtTypeCode": "STATE",
                                "courtName": "SUPREME",
                                "courtLocation": "NASSAU COUNTY, NEW YORK"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "N",
                            "disclosureEventDateDetails": {
                                "date": "2009-09-02"
                            },
                            "dispositionTypeCode": "DISCHARGED",
                            "disclosureEventTypeCode": "CIVIL",
                            "judgementLienOwedAmount": 61506.27,
                            "lienHolderName": "KEN WEINSTIEN",
                            "dispositionDateDetails": {
                                "date": "2012-01-14"
                            }
                        }
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1466638,
                "disclosures": [
                    {
                        "disclosureTypeCode": "JUDGEMNT",
                        "amendment": true,
                        "identifier": 1409515,
                        "disclosureVersion": "05/2009",
                        "finraReceivedDate": "2015-12-17",
                        "questions": "14M",
                        "submittingFirmCrdNumber": 793,
                        "filingIdentifier": 42556065,
                        "judgementLien": {
                            "disclosureDiscoveredDateDetails": {
                                "date": "2009-07-07",
                                "dateExplanation": "DO NOT KNOW THE DATE IT WAS FILED BY THE IRS"
                            },
                            "courtDetails": {
                                "courtTypeCode": "OTHER",
                                "courtName": "IRS",
                                "courtLocation": "KANSAS CITY, MD",
                                "courtTypeOtherText": "IRS"
                            },
                            "disclosureEventPendingFlag": "N",
                            "courtCaseNumberPIIFlag": "Y",
                            "disclosureEventDateDetails": {
                                "date": "2009-07-07",
                                "dateExplanation": "DO NOT KNOW THE DATE IT WAS FILED BY THE IRS"
                            },
                            "dispositionTypeCode": "RELEASED",
                            "disclosureEventTypeCode": "TAX",
                            "judgementLienOwedAmount": 66412.17,
                            "lienHolderName": "IRS",
                            "commentText": "THE AMOUNT OF THIS LEVY IS NOT CORRECT AS MY 2008 TAXES WERE FILED IN JUNE 2009 AND THERE IS A REFUND DUE THAT WOULD CHANGE AMOUNT OF LEVY.  ALSO I HAVE HAD AND CONTINUE TO HAVE DISUCSSIONS WITH IRS TO CREATE AN INSTALLMENT AGREEMENT FOR TAXES OWED AND COMPLETE A PAYMENT AGREEMENT.",
                            "dispositionDateDetails": {
                                "date": "2014-01-17"
                            }
                        }
                    }
                ],
                "discloseToPublicFlag": "N"
            },
            {
                "reportableFlag": "N",
                "occurrenceIdentifier": 1544,
                "disclosures": [
                    {
                        "disclosureTypeCode": "ARBTN",
                        "regulatorName": "FINRA",
                        "amendment": false,
                        "identifier": 400159,
                        "sroArbitration": {
                            "arbitrationAuthorityName": "NASD",
                            "employingFirmName": "SHEARSON LEHMAN BROTHERS, INC.",
                            "disclosureEventDetailText": "MISREPRESENTATION; BRCH OF FIDUCIARY DT;\r\nACCOUNT RELATED - FAILURE TO SUPERVISE; OMISSION OF FACTS",
                            "disclosureEventDate": "1993-05-17",
                            "caseNumberText": "93-01713",
                            "disclosureEventPendingFlag": "N",
                            "caseName": "EDWARD NORDAN VS. SHEARSON LEHMAN BROTHERS,\r\nINC., JONATHAN S. GOLD, ROBERT FINKELSTEIN AND JODY EISENMAN",
                            "allegationAmount": 65627,
                            "dispositionDetails": {
                                "dispositionTypeCode": "OTHER",
                                "dispositionDetailText": "CASE IS CLOSED, BY HEARING\r\nPUNITIVE/EXEMPLARY DAMAGES, RELIEF\r\nREQUEST HAS BEEN DENIED IN FULL; ACTUAL/COMPENSATORY DAMAGES,\r\nRELIEF REQUEST HAS BEEN DENIED IN FULL; ATTORNEY'S FEES, RELIEF\r\nREQUEST HAS BEEN DENIED IN FULL; INTEREST, RELIEF REQUEST HAS\r\nBEEN DENIED IN FULL; OTHER MONETARY RELIEF, RELIEF REQUEST HAS\r\nBEEN DENIED IN FULL; TREBLE DAMAGES, RELIEF REQUEST HAS BEEN\r\nDENIED IN FULL",
                                "dispositionDate": "1994-02-11"
                            }
                        },
                        "disclosureVersion": "10/2005",
                        "finraReceivedDate": "1994-02-11",
                        "filingIdentifier": 152713
                    }
                ],
                "discloseToPublicFlag": "N"
            }
        ],
        "exams": [
            {
                "score": "0",
                "code": "S65",
                "enrollmentIdentifier": 0,
                "id": 17425033,
                "updateTimestamp": "1999-06-18T00:00:00",
                "status": {
                    "date": "1999-06-18",
                    "code": "EXPIRED"
                }
            },
            {
                "code": "S63",
                "enrollmentIdentifier": 0,
                "gradeCode": "PASSED",
                "validity": "Y",
                "id": 17425032,
                "dateTaken": "1982-10-05",
                "updateTimestamp": "2018-09-29T15:17:49.185381",
                "status": {
                    "date": "1982-10-05",
                    "code": "OFFICIAL_RESULT"
                }
            },
            {
                "code": "S63",
                "enrollmentIdentifier": 0,
                "gradeCode": "PASSED",
                "id": 17425032,
                "dateTaken": "1982-10-05",
                "updateTimestamp": "2018-09-29T11:59:01.47111",
                "status": {
                    "date": "1982-10-05",
                    "code": "OFFICIAL_RESULT"
                }
            },
            {
                "score": "76",
                "code": "S63",
                "enrollmentIdentifier": 0,
                "gradeCode": "PASSED",
                "id": 17425032,
                "dateTaken": "1982-10-05",
                "updateTimestamp": "1982-10-05T00:00:00",
                "status": {
                    "date": "1982-10-05",
                    "code": "OFFICIAL_RESULT"
                }
            },
            {
                "code": "S65",
                "enrollmentIdentifier": 0,
                "windowBeginDate": "2012-03-16",
                "id": 17425035,
                "updateTimestamp": "2012-07-16T00:15:34",
                "status": {
                    "date": "2012-07-16",
                    "code": "EXPIRED"
                },
                "windowEndDate": "2012-07-14"
            },
            {
                "score": "194",
                "code": "S7",
                "enrollmentIdentifier": 0,
                "gradeCode": "PASSED",
                "id": 17425037,
                "dateTaken": "1982-01-16",
                "updateTimestamp": "1982-01-16T00:00:00",
                "status": {
                    "date": "1982-01-16",
                    "code": "OFFICIAL_RESULT"
                }
            },
            {
                "code": "SIE",
                "validity": "Y",
                "id": 37127971,
                "updateTimestamp": "2018-09-29T15:17:49.179676",
                "status": {
                    "date": "2018-10-01",
                    "code": "CREDIT"
                }
            },
            {
                "code": "S65",
                "enrollmentIdentifier": 57342946,
                "id": 35289612,
                "updateTimestamp": "2015-10-29T09:48:05.804166",
                "status": {
                    "date": "2015-10-29",
                    "code": "REQUESTED"
                }
            }
        ],
        "individual": {
            "employmentHistory": [
                {
                    "employmentStartDate": "2017-08-01",
                    "nonIndustryEmploymentsInstanceNumber": 11019534,
                    "address": {
                        "cityName": "JERICHO",
                        "countryCode": "USA",
                        "countryLongName": "United States",
                        "postalCode": null,
                        "stateCode": "NY"
                    },
                    "employerFirmName": "FINRA",
                    "investmentRelatedIndicator": "Y",
                    "positionDescription": "FINANCIAL ADVISOR"
                },
                {
                    "employmentStartDate": "2012-02-01",
                    "nonIndustryEmploymentsInstanceNumber": 7229675,
                    "address": {
                        "cityName": "GARDEN CITY",
                        "countryCode": "USA",
                        "countryLongName": "United States",
                        "postalCode": null,
                        "stateCode": "NY"
                    },
                    "employerFirmName": "STIFEL NICOLAUS & CO INC",
                    "investmentRelatedIndicator": "Y",
                    "positionDescription": "FINANCIAL ADVISOR",
                    "employmentEndDate": "2017-08-01"
                },
                {
                    "employmentStartDate": "2007-12-01",
                    "nonIndustryEmploymentsInstanceNumber": 4252505,
                    "address": {
                        "cityName": "PHILADELPHIA",
                        "countryCode": "USA",
                        "countryLongName": "United States",
                        "postalCode": null,
                        "stateCode": "PA"
                    },
                    "employerFirmName": "TEST FIRM 2",
                    "investmentRelatedIndicator": "Y",
                    "positionDescription": "REGISTERED REPRESENTATIVE",
                    "employmentEndDate": "2012-02-01"
                }
            ],
            "regulatoryStatus": {
                "militaryDeferralApproved": "N",
                "statutorilyDisqualifiedStatusCode": "BLNK"
            },
            "biometrics": {
                "genderCode": "M",
                "heightInInches": 11,
                "heightInFeet": 5,
                "hairColorCode": "BRO",
                "weight": 185,
                "eyeColorCode": "BRO"
            },
            "aliases": [],
            "personalInformation": {
                "countryCodeOfBirth": "USA",
                "individualName": {
                    "firstName": "MATT",
                    "lastName": "SMITH",
                    "middleName": "SCOTT"
                },
                "dateOfBirth": "1962-06-01",
                "stateOfBirth": "NY"
            },
            "crdNumber": 12345,
            "iaAffiliations": [],
            "anyDisclosureMaterialUpdates": false,
            "otherBusinesses": [
                {}
            ],
            "professionalDesignations": [],
            "residentialHistory": [
                {
                    "addressEndDate": "2005-12-01",
                    "address": {
                        "cityName": "FLOWER HILL",
                        "countryCode": "USA",
                        "countryLongName": "United States",
                        "postalCode": "11050",
                        "addressLine1": "123 WALPOLE COURT",
                        "stateCode": "NY"
                    },
                    "addressStartDate": "2005-11-01",
                    "id": 1188363
                },
                {
                    "addressEndDate": "2009-07-01",
                    "address": {
                        "cityName": "PORT WASHINGTON",
                        "countryCode": "USA",
                        "countryLongName": "United States",
                        "postalCode": "11050",
                        "addressLine1": "10 TIN COURT",
                        "stateCode": "NY"
                    },
                    "addressStartDate": "2005-12-01",
                    "id": 1230754
                },
                {
                    "addressEndDate": "2011-11-01",
                    "address": {
                        "cityName": "ROSLYN",
                        "countryCode": "USA",
                        "countryLongName": "United States",
                        "postalCode": "11576",
                        "addressLine1": "123 BRASS ROAD",
                        "stateCode": "NY"
                    },
                    "addressStartDate": "2009-07-01",
                    "id": 2716061
                }
            ]
        },
        "firmAssociations": [
            {
                "isIndependentContractor": "N",
                "registrations": [
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "MNL",
                            "reasonCode": "DISCLR"
                        },
                        "endDate": "2018-12-31",
                        "registrationCategoryCode": "AG",
                        "regulatorIdentifier": 50013,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            },
                            {
                                "isCleared": "Y",
                                "code": "FINRA",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "TERMED"
                        }
                    },
                    {
                        "beginDate": "2019-02-07",
                        "reviewMethod": {
                            "code": "MNL",
                            "reasonCode": "DISCLR"
                        },
                        "registrationCategoryCode": "AG",
                        "regulatorIdentifier": 50018,
                        "instanceNumber": 2,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            },
                            {
                                "isCleared": "Y",
                                "code": "FINRA",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-09-08",
                        "reviewMethod": {
                            "code": "MNL",
                            "reasonCode": "DISCLR"
                        },
                        "registrationCategoryCode": "AG",
                        "regulatorIdentifier": 50039,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            },
                            {
                                "isCleared": "Y",
                                "code": "FINRA",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "endDate": "2018-10-01",
                        "registrationCategoryCode": "BM",
                        "regulatorIdentifier": 50006,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "ADMTERM"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "endDate": "2018-10-01",
                        "registrationCategoryCode": "BM",
                        "regulatorIdentifier": 50098,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "ADMTERM"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "ATMTC",
                            "reasonCode": "DSCLRAUTO"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 1,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50001,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50003,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50004,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50006,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50007,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50008,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50098,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "GS",
                        "regulatorIdentifier": 50102,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "ATMTC",
                            "reasonCode": "DSCLRAUTO"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 1,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2018-10-01",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50001,
                        "instanceNumber": 1,
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50003,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "endDate": "2018-09-30",
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50004,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "ADMTERM"
                        }
                    },
                    {
                        "beginDate": "2019-03-01",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50004,
                        "instanceNumber": 2,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2018-10-01",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50006,
                        "instanceNumber": 1,
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50007,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50008,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2018-10-01",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50098,
                        "instanceNumber": 1,
                        "status": {
                            "code": "APPROVED"
                        }
                    },
                    {
                        "beginDate": "2017-08-31",
                        "reviewMethod": {
                            "code": "SUPERATMTC"
                        },
                        "registrationCategoryCode": "SU",
                        "regulatorIdentifier": 50102,
                        "instanceNumber": 1,
                        "deficiencies": [
                            {
                                "isCleared": "Y",
                                "code": "SRR_RVW",
                                "clearedDate": "2017-08-31",
                                "createDate": "2017-08-31"
                            }
                        ],
                        "status": {
                            "code": "APPROVED"
                        }
                    }
                ],
                "fingerprint": {
                    "cards": [
                        {
                            "identifier": 8269153,
                            "takenDate": "2017-08-31",
                            "areResultsProcessed": false,
                            "receivedDate": "2017-08-31",
                            "updateTimeStamp": "2017-08-31T11:21:45",
                            "barCode": "2540432083"
                        },
                        {
                            "identifier": 8270382,
                            "takenDate": "2017-08-31",
                            "areResultsProcessed": true,
                            "receivedDate": "2017-09-01",
                            "updateTimeStamp": "2017-09-06T09:44:38",
                            "barCode": "2540433076"
                        }
                    ],
                    "exemptionCodes": [],
                    "classification": "PRVD"
                },
                "firmName": "FINRA",
                "firmCrdNumber": 1,
                "locations": [
                    {
                        "address": {
                            "cityName": "JERICHO",
                            "countryCode": "USA",
                            "postalCode": "11753",
                            "addressLine1": "2 JERICHO PLAZA",
                            "addressLine2": "SUITE 113",
                            "stateCode": "NY"
                        },
                        "firmBillingCode": "D23",
                        "instanceNumber": 1,
                        "branchCrdNumber": 190607,
                        "startDate": "2017-08-29",
                        "isPrivateResidence": "N"
                    },
                    {
                        "address": {
                            "cityName": "DELRAY BEACH",
                            "countryCode": "USA",
                            "postalCode": "33446",
                            "addressLine1": "16226  CABERNET DRIVE",
                            "stateCode": "FL"
                        },
                        "endDate": "2021-11-29",
                        "firmBillingCode": "D23-2",
                        "instanceNumber": 1,
                        "branchCrdNumber": 769640,
                        "startDate": "2021-08-20",
                        "isPrivateResidence": "Y"
                    }
                ],
                "employeeBillingCode": "D23",
                "startDate": "2017-08-29"
            }
        ],
        "annualContinuingEducation": {
            "bdCeYearlyData": [
                {
                    "year": "2023",
                    "assignedCourses": [
                        {
                            "courseName": "Determining Fair Prices and Markups",
                            "dueDate": "2023-12-31",
                            "courseId": "RE2023-011",
                            "status": {
                                "code": "ASSIGNED",
                                "description": "Assigned"
                            }
                        },
                        {
                            "courseName": "Data Access Management",
                            "dueDate": "2023-12-31",
                            "courseId": "RE2023-002",
                            "status": {
                                "code": "ASSIGNED",
                                "description": "Assigned"
                            }
                        },
                        {
                            "courseName": "Information Protection",
                            "dueDate": "2023-12-31",
                            "courseId": "RE2023-003",
                            "status": {
                                "code": "ASSIGNED",
                                "description": "Assigned"
                            }
                        },
                        {
                            "courseName": "Navigating Regulation BI",
                            "dueDate": "2023-12-31",
                            "courseId": "RE2023-004",
                            "status": {
                                "code": "ASSIGNED",
                                "description": "Assigned"
                            }
                        }
                    ]
                }
            ],
            "status": {
                "code": "REQUIRED",
                "description": "Required",
                "timestamp": "2023-01-01T00:00:00"
            }
        },
        "investmentAdviserContinuingEducation": {
            "requirements": [
                {
                    "year": "2023",
                    "dueDate": "2023-12-31",
                    "ppEarnedCredits": 6,
                    "creditRequirements": [
                        {
                            "requiredCredits": 6,
                            "earnedCredits": 6,
                            "type": {
                                "code": "PP",
                                "description": "Products & Practice"
                            },
                            "status": {
                                "code": "COMPLETE",
                                "description": "Complete",
                                "timestamp": "2023-09-06T21:29:45.743"
                            }
                        },
                        {
                            "requiredCredits": 6,
                            "earnedCredits": 0,
                            "type": {
                                "code": "EPR",
                                "description": "Ethics & Professional Responsibility"
                            },
                            "status": {
                                "code": "INCOMPLETE",
                                "description": "Incomplete",
                                "timestamp": "2022-12-29T14:09:17.963"
                            }
                        }
                    ],
                    "totalEarnedCredits": 6,
                    "status": {
                        "code": "INCOMPLETE",
                        "description": "Incomplete",
                        "timestamp": "2022-12-29T14:09:17.963"
                    },
                    "eprEarnedCredits": 0
                },
                {
                    "year": "2022",
                    "dueDate": "2022-12-31",
                    "ppEarnedCredits": 6,
                    "creditRequirements": [
                        {
                            "requiredCredits": 6,
                            "earnedCredits": 6,
                            "type": {
                                "code": "PP",
                                "description": "Products & Practice"
                            },
                            "status": {
                                "code": "COMPLETE",
                                "description": "Complete",
                                "timestamp": "2022-10-20T17:11:44.283"
                            }
                        },
                        {
                            "requiredCredits": 6,
                            "earnedCredits": 5,
                            "type": {
                                "code": "EPR",
                                "description": "Ethics & Professional Responsibility"
                            },
                            "status": {
                                "code": "INCOMPLETE",
                                "description": "Incomplete",
                                "timestamp": "2022-06-08T12:01:52.977"
                            }
                        }
                    ],
                    "totalEarnedCredits": 11,
                    "status": {
                        "code": "INCOMPLETE",
                        "description": "Incomplete",
                        "timestamp": "2022-06-08T12:01:52.977"
                    },
                    "eprEarnedCredits": 5
                }
            ],
            "status": {
                "code": "INACTIVE",
                "description": "IARCE Inactive"
            }
        },
        "events": [
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "AMENDMENT",
                    "formVersion": "05/2009",
                    "id": 58762410
                },
                "eventTypeCode": "FLNG",
                "id": 58762410,
                "eventDate": "2022-04-26"
            },
            {
                "filing": {
                    "formTypeCode": "U5",
                    "filingTypeCode": "AMENDMENT",
                    "formVersion": "05/2009",
                    "id": 57808467
                },
                "eventTypeCode": "FLNG",
                "id": 57808467,
                "eventDate": "2021-12-17"
            },
            {
                "eventTypeCode": "BRFLNG",
                "id": 57005871,
                "eventDate": "2021-08-20"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "AMENDMENT",
                    "formVersion": "05/2009",
                    "id": 54601593
                },
                "eventTypeCode": "FLNG",
                "id": 54601593,
                "eventDate": "2020-08-24"
            },
            {
                "filing": {
                    "formTypeCode": "U5",
                    "filingTypeCode": "PARTIAL",
                    "formVersion": "05/2009",
                    "id": 50465887
                },
                "eventTypeCode": "FLNG",
                "id": 50465887,
                "eventDate": "2018-12-06"
            },
            {
                "eventTypeCode": "NFITERMRGSTN",
                "regulatorIdentifier": 1,
                "id": 49953299,
                "eventDate": "2018-10-01"
            },
            {
                "eventTypeCode": "NFIADDRGSTN",
                "regulatorIdentifier": 1,
                "id": 49929484,
                "eventDate": "2018-10-01"
            },
            {
                "eventTypeCode": "BRFLNG",
                "id": 49677267,
                "eventDate": "2018-08-28"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "RELICENSE",
                    "formVersion": "05/2009",
                    "id": 47144087
                },
                "eventTypeCode": "FLNG",
                "id": 47144087,
                "eventDate": "2017-08-29"
            },
            {
                "eventTypeCode": "BRFLNG",
                "id": 40442292,
                "eventDate": "2006-10-31"
            },
            {
                "eventTypeCode": "BRFLNG",
                "id": 39869153,
                "eventDate": "2005-12-14"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "RELICENSE",
                    "formVersion": "05/2009",
                    "id": 31929715
                },
                "eventTypeCode": "FLNG",
                "id": 31929715,
                "eventDate": "2012-02-01"
            },
            {
                "filing": {
                    "formTypeCode": "U5",
                    "filingTypeCode": "PARTIAL",
                    "formVersion": "05/2009",
                    "id": 31615865
                },
                "eventTypeCode": "FLNG",
                "id": 31615865,
                "eventDate": "2011-12-20"
            },
            {
                "eventTypeCode": "WLFLREGACTNQSTNS",
                "id": 25706761,
                "eventDate": "2009-05-29"
            },
            {
                "filing": {
                    "formTypeCode": "U5",
                    "filingTypeCode": "PARTIAL",
                    "formVersion": "10/2005",
                    "id": 25061810
                },
                "eventTypeCode": "FLNG",
                "id": 25061810,
                "eventDate": "2009-03-27"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "AMENDMENT",
                    "formVersion": "10/2005",
                    "id": 24811468
                },
                "eventTypeCode": "FLNG",
                "id": 24811468,
                "eventDate": "2009-02-04"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "AMENDMENT",
                    "formVersion": "10/2005",
                    "id": 24227695
                },
                "eventTypeCode": "FLNG",
                "id": 24227695,
                "eventDate": "2008-10-24"
            },
            {
                "filing": {
                    "formTypeCode": "U5",
                    "filingTypeCode": "PARTIAL",
                    "formVersion": "10/2005",
                    "id": 22961955
                },
                "eventTypeCode": "FLNG",
                "id": 22961955,
                "eventDate": "2008-04-15"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "AMENDMENT",
                    "formVersion": "06/2003",
                    "id": 16302746
                },
                "eventTypeCode": "FLNG",
                "id": 16302746,
                "eventDate": "2005-10-24"
            },
            {
                "filing": {
                    "formTypeCode": "U5",
                    "filingTypeCode": "PARTIAL",
                    "formVersion": "08/1999",
                    "id": 9147733
                },
                "eventTypeCode": "FLNG",
                "id": 9147733,
                "eventDate": "2001-12-18"
            },
            {
                "eventTypeCode": "U5CNVRN",
                "id": 1199132,
                "eventDate": "1999-07-05"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "CONVERSION",
                    "formVersion": "08/1999",
                    "id": 1199130
                },
                "eventTypeCode": "FLNG",
                "id": 1199130,
                "eventDate": "1999-08-07"
            },
            {
                "eventTypeCode": "U5CNVRN",
                "id": 1199098,
                "eventDate": "1999-07-05"
            },
            {
                "filing": {
                    "formTypeCode": "U4",
                    "filingTypeCode": "CONVERSION",
                    "formVersion": "08/1999",
                    "id": 1199097
                },
                "eventTypeCode": "FLNG",
                "id": 1199097,
                "eventDate": "1999-08-07"
            },
            {
                "filing": {
                    "formTypeCode": "U5",
                    "filingTypeCode": "CONVERSION",
                    "formVersion": "08/1999",
                    "id": 117472
                },
                "eventTypeCode": "FLNG",
                "id": 117472,
                "eventDate": "1999-08-07"
            }
        ]
    }
]'''

import json
import pandas as pd
from pandas import json_normalize

# data = json.loads(dataOld, strict=False)

# # Extract the 'occurrences' section
# events_occurrences = data[0]['occurrences']  # Adjust indexing based on your JSON structure
# # Normalize the data
# df_occurrences = pd.json_normalize(events_occurrences)
# print(df_occurrences)


# # 'occurrences'
# #   'exams'
# #   'individual'
# #   'firmAssociations

# #        'annualContinuingEducation'
# #        'investmentAdviserContinuingEducation'
# #        'events'



# # Extract the 'events' section
# events_data = data[0]['events']  # Adjust indexing based on your JSON structure

# # Normalize the data
# df_events = pd.json_normalize(events_data)

# print(df_events)

# Load the JSON data
data = json.loads(dataOld, strict=False)

# Assuming `data` is a list and we are working with the first item as shown in your example
item = data[0]

# Extract sections into dataframes
df_occurrences = pd.json_normalize(item['occurrences'])
df_occurrences['individualCrdNumber'] = 12345  # Adding the individualCrdNumber for correlation

# Normalize disclosures data
# Since each row in `df_occurrences` may contain a list of disclosures, iterate through each and normalize
# Collect all disclosure dataframes and concatenate them at the end
all_disclosures = []
for index, row in df_occurrences.iterrows():
    df_disclosure = json_normalize(
        row['disclosures'],
        errors='ignore'
    )
    df_disclosure['occurrenceIdentifier'] = row['occurrenceIdentifier']  # Add the occurrence identifier to each disclosure
    all_disclosures.append(df_disclosure)

# Concatenate all normalized disclosure dataframes into a single dataframe
df_disclosures = pd.concat(all_disclosures, ignore_index=True)

# Merge df_occurrences and df_disclosures based on 'occurrenceIdentifier'
occurrences_df = pd.merge(
    df_occurrences,
    df_disclosures,
    on='occurrenceIdentifier',
    how='left'  # Using left join to keep all occurrences even if they don't have disclosures
)

exams_df = pd.json_normalize(item['exams'])
exams_df['individualCrdNumber'] = 12345

# Since individual information is not a list, we encapsulate it in a list to normalize
individual_df = pd.json_normalize([item['individual']])
individual_df['individualCrdNumber'] = 12345

firm_associations_df = pd.json_normalize(item['firmAssociations'])
firm_associations_df['individualCrdNumber'] = 12345

# Handling 'annualContinuingEducation'
annual_ce_df = pd.json_normalize(item['annualContinuingEducation']['bdCeYearlyData'])
annual_ce_df['individualCrdNumber'] = 12345

# Handling 'investmentAdviserContinuingEducation'
ia_ce_df = pd.json_normalize(item['investmentAdviserContinuingEducation']['requirements'])
ia_ce_df['individualCrdNumber'] = 12345

events_df = pd.json_normalize(item['events'])
events_df['individualCrdNumber'] = 12345

# Now you have each section in separate dataframes, each linked by individualCrdNumber
# You can now work with these dataframes as needed, perform joins, aggregations, etc.


import pandas as pd

# Assuming the dataframes have been created as per the previous example and named accordingly:
# occurrences_df, exams_df, individual_df, firm_associations_df, annual_ce_df, ia_ce_df, events_df

# Perform the joins
from functools import reduce

# List all dataframes you want to join
dfs = [occurrences_df, exams_df, individual_df, firm_associations_df, annual_ce_df, ia_ce_df, events_df]

# Use reduce from functools to apply merging iteratively
final_df = reduce(lambda left, right: pd.merge(left, right, on='individualCrdNumber', how='inner'), dfs)

# Now, final_df contains the joined data based on individualCrdNumber
print(final_df.head())  # Display the first few rows of the final dataframe

# Create a CSV
final_df.to_csv('sample.csv')
